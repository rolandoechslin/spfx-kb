{
  "$schema": "https://developer.microsoft.com/json-schemas/sp/site-design-script-actions.schema.json",
  "actions": [
    {
      "verb": "createSPList",
      "listName": "To Do",
      "templateType": 100,
      "color": "0",
      "icon": "3",
      "subactions": [
        {
          "verb": "setDescription",
          "description": "The tasks available in the SharePoint home page are stored in this list"
        },
        {
          "verb": "addSPFieldXml",
          "schemaXml": "<Field ID=\"{fa564e0f-0c70-4ab9-b863-0177e6ddd247}\" Type=\"Text\" Name=\"Title\" DisplayName=\"Title\" Required=\"TRUE\" SourceID=\"http://schemas.microsoft.com/sharepoint/v3\" StaticName=\"Title\" FromBaseType=\"TRUE\" MaxLength=\"255\" />"
        },
        {
          "verb": "addSPFieldXml",
          "schemaXml": "<Field AppendOnly=\"FALSE\" DisplayName=\"Description\" Format=\"Dropdown\" IsModern=\"TRUE\" IsolateStyles=\"FALSE\" Name=\"Description\" RichText=\"FALSE\" RichTextMode=\"Compatible\" Title=\"Description\" Type=\"Note\" ID=\"{780a802b-2bdf-4865-812e-b0a75ae96157}\" StaticName=\"Description\" />"
        },
        {
          "verb": "addSPFieldXml",
          "schemaXml": "<Field ClientSideComponentId=\"00000000-0000-0000-0000-000000000000\" CustomFormatter=\"{&quot;elmType&quot;:&quot;div&quot;,&quot;style&quot;:{&quot;flex-wrap&quot;:&quot;wrap&quot;,&quot;display&quot;:&quot;flex&quot;},&quot;children&quot;:[{&quot;elmType&quot;:&quot;div&quot;,&quot;style&quot;:{&quot;box-sizing&quot;:&quot;border-box&quot;,&quot;padding&quot;:&quot;4px 8px 5px 8px&quot;,&quot;display&quot;:&quot;flex&quot;,&quot;border-radius&quot;:&quot;16px&quot;,&quot;height&quot;:&quot;24px&quot;,&quot;align-items&quot;:&quot;center&quot;,&quot;white-space&quot;:&quot;nowrap&quot;,&quot;overflow&quot;:&quot;hidden&quot;,&quot;margin&quot;:&quot;4px 4px 4px 4px&quot;},&quot;attributes&quot;:{&quot;class&quot;:{&quot;operator&quot;:&quot;:&quot;,&quot;operands&quot;:[{&quot;operator&quot;:&quot;==&quot;,&quot;operands&quot;:[&quot;[$Category]&quot;,&quot;Blue&quot;]},&quot;sp-css-backgroundColor-BgCornflowerBlue&quot;,{&quot;operator&quot;:&quot;:&quot;,&quot;operands&quot;:[{&quot;operator&quot;:&quot;==&quot;,&quot;operands&quot;:[&quot;[$Category]&quot;,&quot;Green&quot;]},&quot;sp-css-backgroundColor-BgMintGreen&quot;,{&quot;operator&quot;:&quot;:&quot;,&quot;operands&quot;:[{&quot;operator&quot;:&quot;==&quot;,&quot;operands&quot;:[&quot;[$Category]&quot;,&quot;Yellow&quot;]},&quot;sp-css-backgroundColor-BgGold&quot;,{&quot;operator&quot;:&quot;:&quot;,&quot;operands&quot;:[{&quot;operator&quot;:&quot;==&quot;,&quot;operands&quot;:[&quot;[$Category]&quot;,&quot;&quot;]},&quot;&quot;,{&quot;operator&quot;:&quot;:&quot;,&quot;operands&quot;:[{&quot;operator&quot;:&quot;==&quot;,&quot;operands&quot;:[&quot;[$Category]&quot;,&quot;Red&quot;]},&quot;sp-css-backgroundColor-BgCoral&quot;,&quot;sp-field-borderAllRegular sp-field-borderAllSolid sp-css-borderColor-neutralSecondary&quot;]}]}]}]}]}},&quot;children&quot;:[{&quot;elmType&quot;:&quot;span&quot;,&quot;style&quot;:{&quot;line-height&quot;:&quot;16px&quot;,&quot;height&quot;:&quot;14px&quot;},&quot;attributes&quot;:{&quot;iconName&quot;:{&quot;operator&quot;:&quot;:&quot;,&quot;operands&quot;:[{&quot;operator&quot;:&quot;==&quot;,&quot;operands&quot;:[&quot;[$Category]&quot;,&quot;Blue&quot;]},&quot;&quot;,{&quot;operator&quot;:&quot;:&quot;,&quot;operands&quot;:[{&quot;operator&quot;:&quot;==&quot;,&quot;operands&quot;:[&quot;[$Category]&quot;,&quot;Green&quot;]},&quot;&quot;,{&quot;operator&quot;:&quot;:&quot;,&quot;operands&quot;:[{&quot;operator&quot;:&quot;==&quot;,&quot;operands&quot;:[&quot;[$Category]&quot;,&quot;Yellow&quot;]},&quot;&quot;,{&quot;operator&quot;:&quot;:&quot;,&quot;operands&quot;:[{&quot;operator&quot;:&quot;==&quot;,&quot;operands&quot;:[&quot;[$Category]&quot;,&quot;&quot;]},&quot;&quot;,{&quot;operator&quot;:&quot;:&quot;,&quot;operands&quot;:[{&quot;operator&quot;:&quot;==&quot;,&quot;operands&quot;:[&quot;[$Category]&quot;,&quot;Red&quot;]},&quot;&quot;,&quot;&quot;]}]}]}]}]},&quot;class&quot;:{&quot;operator&quot;:&quot;:&quot;,&quot;operands&quot;:[{&quot;operator&quot;:&quot;==&quot;,&quot;operands&quot;:[&quot;[$Category]&quot;,&quot;Blue&quot;]},&quot;&quot;,{&quot;operator&quot;:&quot;:&quot;,&quot;operands&quot;:[{&quot;operator&quot;:&quot;==&quot;,&quot;operands&quot;:[&quot;[$Category]&quot;,&quot;Green&quot;]},&quot;&quot;,{&quot;operator&quot;:&quot;:&quot;,&quot;operands&quot;:[{&quot;operator&quot;:&quot;==&quot;,&quot;operands&quot;:[&quot;[$Category]&quot;,&quot;Yellow&quot;]},&quot;&quot;,{&quot;operator&quot;:&quot;:&quot;,&quot;operands&quot;:[{&quot;operator&quot;:&quot;==&quot;,&quot;operands&quot;:[&quot;[$Category]&quot;,&quot;&quot;]},&quot;&quot;,{&quot;operator&quot;:&quot;:&quot;,&quot;operands&quot;:[{&quot;operator&quot;:&quot;==&quot;,&quot;operands&quot;:[&quot;[$Category]&quot;,&quot;Red&quot;]},&quot;&quot;,&quot;&quot;]}]}]}]}]}}},{&quot;elmType&quot;:&quot;span&quot;,&quot;style&quot;:{&quot;overflow&quot;:&quot;hidden&quot;,&quot;text-overflow&quot;:&quot;ellipsis&quot;,&quot;padding&quot;:&quot;0 3px&quot;},&quot;txtContent&quot;:&quot;[$Category]&quot;,&quot;attributes&quot;:{&quot;class&quot;:{&quot;operator&quot;:&quot;:&quot;,&quot;operands&quot;:[{&quot;operator&quot;:&quot;==&quot;,&quot;operands&quot;:[&quot;[$Category]&quot;,&quot;Blue&quot;]},&quot;sp-css-color-CornflowerBlueFont&quot;,{&quot;operator&quot;:&quot;:&quot;,&quot;operands&quot;:[{&quot;operator&quot;:&quot;==&quot;,&quot;operands&quot;:[&quot;[$Category]&quot;,&quot;Green&quot;]},&quot;sp-css-color-MintGreenFont&quot;,{&quot;operator&quot;:&quot;:&quot;,&quot;operands&quot;:[{&quot;operator&quot;:&quot;==&quot;,&quot;operands&quot;:[&quot;[$Category]&quot;,&quot;Yellow&quot;]},&quot;sp-css-color-GoldFont&quot;,{&quot;operator&quot;:&quot;:&quot;,&quot;operands&quot;:[{&quot;operator&quot;:&quot;==&quot;,&quot;operands&quot;:[&quot;[$Category]&quot;,&quot;&quot;]},&quot;&quot;,{&quot;operator&quot;:&quot;:&quot;,&quot;operands&quot;:[{&quot;operator&quot;:&quot;==&quot;,&quot;operands&quot;:[&quot;[$Category]&quot;,&quot;Red&quot;]},&quot;sp-field-fontSizeSmall sp-css-color-CoralFont&quot;,&quot;&quot;]}]}]}]}]}}}]}],&quot;templateId&quot;:&quot;BgColorChoicePill&quot;}\" DisplayName=\"Category\" FillInChoice=\"FALSE\" Format=\"Dropdown\" Name=\"Category\" Title=\"Category\" Type=\"Choice\" ID=\"{788f0df7-7e0e-44fc-8825-d3bc017ced45}\" StaticName=\"Category\"><CHOICES><CHOICE>Blue</CHOICE><CHOICE>Green</CHOICE><CHOICE>Yellow</CHOICE><CHOICE>Red</CHOICE></CHOICES></Field>"
        },
        {
          "verb": "addSPFieldXml",
          "schemaXml": "<Field DisplayName=\"Duedate\" FriendlyDisplayFormat=\"Disabled\" Format=\"DateOnly\" IsModern=\"TRUE\" Name=\"Duedate\" Title=\"Duedate\" Type=\"DateTime\" ID=\"{22ba7f04-e26b-4494-8bd3-06781c183171}\" StaticName=\"Duedate\" />"
        },
        {
          "verb": "addSPFieldXml",
          "schemaXml": "<Field DisplayName=\"Important\" Format=\"Dropdown\" IsModern=\"TRUE\" Name=\"Important\" Title=\"Important\" Type=\"Boolean\" ID=\"{56696f69-bb4c-43f9-95e2-9232a40547ac}\" StaticName=\"Important\" CustomFormatter=\"{&quot;$schema&quot;:&quot;https://developer.microsoft.com/json-schemas/sp/v2/column-formatting.schema.json&quot;,&quot;elmType&quot;:&quot;div&quot;,&quot;style&quot;:{&quot;display&quot;:&quot;flex&quot;,&quot;width&quot;:&quot;100%&quot;,&quot;height&quot;:&quot;100%&quot;,&quot;align-items&quot;:&quot;center&quot;},&quot;children&quot;:[{&quot;elmType&quot;:&quot;div&quot;,&quot;style&quot;:{&quot;display&quot;:&quot;flex&quot;,&quot;width&quot;:&quot;60px&quot;,&quot;height&quot;:&quot;30px&quot;,&quot;border-radius&quot;:&quot;15px&quot;,&quot;align-items&quot;:&quot;center&quot;,&quot;flex-direction&quot;:&quot;row&quot;,&quot;justify-content&quot;:&quot;=if(@currentField , 'flex-end' , 'flex-start')&quot;,&quot;cursor&quot;:&quot;pointer&quot;},&quot;customRowAction&quot;:{&quot;action&quot;:&quot;setValue&quot;,&quot;actionInput&quot;:{&quot;status&quot;:&quot;=if(@currentField , '0' , '1' )&quot;}},&quot;attributes&quot;:{&quot;class&quot;:&quot;=if(@currentField , 'ms-bgColor-themePrimary' , 'ms-bgColor-neutralTertiaryAlt')&quot;},&quot;children&quot;:[{&quot;elmType&quot;:&quot;div&quot;,&quot;style&quot;:{&quot;width&quot;:&quot;18px&quot;,&quot;height&quot;:&quot;18px&quot;,&quot;margin-left&quot;:&quot;6px&quot;,&quot;margin-right&quot;:&quot;6px&quot;,&quot;border-radius&quot;:&quot;50%&quot;},&quot;attributes&quot;:{&quot;class&quot;:&quot;ms-bgColor-white&quot;}}]}]}\"><Default>0</Default></Field>"
        },
        {
          "verb": "addSPFieldXml",
          "schemaXml": "<Field DisplayName=\"Status\" Format=\"Dropdown\" IsModern=\"TRUE\" Name=\"Status\" Title=\"Status\" Type=\"Boolean\" ID=\"{8edf3c3d-10a4-4032-b553-8b5f797f022a}\" StaticName=\"Status\" CustomFormatter=\"{&quot;$schema&quot;:&quot;https://developer.microsoft.com/json-schemas/sp/v2/column-formatting.schema.json&quot;,&quot;elmType&quot;:&quot;div&quot;,&quot;style&quot;:{&quot;display&quot;:&quot;flex&quot;,&quot;width&quot;:&quot;100%&quot;,&quot;height&quot;:&quot;100%&quot;,&quot;align-items&quot;:&quot;center&quot;},&quot;children&quot;:[{&quot;elmType&quot;:&quot;div&quot;,&quot;style&quot;:{&quot;display&quot;:&quot;flex&quot;,&quot;width&quot;:&quot;60px&quot;,&quot;height&quot;:&quot;30px&quot;,&quot;border-radius&quot;:&quot;15px&quot;,&quot;align-items&quot;:&quot;center&quot;,&quot;flex-direction&quot;:&quot;row&quot;,&quot;justify-content&quot;:&quot;=if(@currentField , 'flex-end' , 'flex-start')&quot;,&quot;cursor&quot;:&quot;pointer&quot;},&quot;customRowAction&quot;:{&quot;action&quot;:&quot;setValue&quot;,&quot;actionInput&quot;:{&quot;status&quot;:&quot;=if(@currentField , '0' , '1' )&quot;}},&quot;attributes&quot;:{&quot;class&quot;:&quot;=if(@currentField , 'ms-bgColor-themePrimary' , 'ms-bgColor-neutralTertiaryAlt')&quot;},&quot;children&quot;:[{&quot;elmType&quot;:&quot;div&quot;,&quot;style&quot;:{&quot;width&quot;:&quot;18px&quot;,&quot;height&quot;:&quot;18px&quot;,&quot;margin-left&quot;:&quot;6px&quot;,&quot;margin-right&quot;:&quot;6px&quot;,&quot;border-radius&quot;:&quot;50%&quot;},&quot;attributes&quot;:{&quot;class&quot;:&quot;ms-bgColor-white&quot;}}]}]}\"><Default>0</Default></Field>"
        },
        {
          "verb": "addSPFieldXml",
          "schemaXml": "<Field Type=\"Calculated\" DisplayName=\"Date\" EnforceUniqueValues=\"FALSE\" Indexed=\"FALSE\" Format=\"DateOnly\" LCID=\"1033\" ResultType=\"Text\" ReadOnly=\"TRUE\" ID=\"{d6a9bff6-171e-415d-a12f-550397b0ca00}\" StaticName=\"Date\" Name=\"Date\" CustomFormatter=\"\" Required=\"FALSE\"><Formula>=CONCATENATE(TEXT(WEEKDAY([Duedate]),\"ddd\"),\", \",TEXT([Duedate],\"mmmm dd, yyyy\"))</Formula></Field>"
        },
        {
          "verb": "addSPFieldXml",
          "schemaXml": "<Field ID=\"{82642ec8-ef9b-478f-acf9-31f7d45fbc31}\" ReadOnly=\"TRUE\" Type=\"Computed\" Name=\"LinkTitle\" DisplayName=\"Title\" DisplayNameSrcField=\"Title\" ClassInfo=\"Menu\" AuthoringInfo=\"(linked to item with edit menu)\" ListItemMenuAllowed=\"Required\" LinkToItemAllowed=\"Prohibited\" SourceID=\"http://schemas.microsoft.com/sharepoint/v3\" StaticName=\"LinkTitle\" FromBaseType=\"TRUE\"><FieldRefs><FieldRef Name=\"Title\" /><FieldRef Name=\"LinkTitleNoMenu\" /><FieldRef Name=\"_EditMenuTableStart2\" /><FieldRef Name=\"_EditMenuTableEnd\" /></FieldRefs><DisplayPattern><FieldSwitch><Expr><GetVar Name=\"FreeForm\" /></Expr><Case Value=\"TRUE\"><Field Name=\"LinkTitleNoMenu\" /></Case><Default><HTML><![CDATA[<div class=\"ms-vb itx\" onmouseover=\"OnItem(this)\" CTXName=\"ctx]]></HTML><Field Name=\"_EditMenuTableStart2\" /><HTML><![CDATA[\">]]></HTML><Field Name=\"LinkTitleNoMenu\" /><HTML><![CDATA[</div>]]></HTML><HTML><![CDATA[<div class=\"s4-ctx\" onmouseover=\"OnChildItem(this.parentNode); return false;\">]]></HTML><HTML><![CDATA[<span>&nbsp;</span>]]></HTML><HTML><![CDATA[<a onfocus=\"OnChildItem(this.parentNode.parentNode); return false;\" onclick=\"PopMenuFromChevron(event); return false;\" href=\"javascript:;\" title=\"Open Menu\"></a>]]></HTML><HTML><![CDATA[<span>&nbsp;</span>]]></HTML><HTML><![CDATA[</div>]]></HTML></Default></FieldSwitch></DisplayPattern></Field>"
        },
        {
          "verb": "addContentType",
          "name": "Item",
          "id": "0x01",
          "fieldRefsXml": [
            "<FieldRef ID=\"{fa564e0f-0c70-4ab9-b863-0177e6ddd247}\" Name=\"Title\" />",
            "<FieldRef ID=\"{82642ec8-ef9b-478f-acf9-31f7d45fbc31}\" Name=\"LinkTitle\" DisplayName=\"Title\" ReadOnly=\"TRUE\" />",
            "<FieldRef ID=\"{780a802b-2bdf-4865-812e-b0a75ae96157}\" Name=\"Description\" />",
            "<FieldRef ID=\"{788f0df7-7e0e-44fc-8825-d3bc017ced45}\" Name=\"Category\" DisplayName=\"Category\" Format=\"Dropdown\" />",
            "<FieldRef ID=\"{22ba7f04-e26b-4494-8bd3-06781c183171}\" Name=\"Duedate\" />",
            "<FieldRef ID=\"{56696f69-bb4c-43f9-95e2-9232a40547ac}\" Name=\"Important\" DisplayName=\"Important\" Format=\"Dropdown\" />",
            "<FieldRef ID=\"{8edf3c3d-10a4-4032-b553-8b5f797f022a}\" Name=\"Status\" DisplayName=\"Status\" Format=\"Dropdown\" />",
            "<FieldRef ID=\"{d6a9bff6-171e-415d-a12f-550397b0ca00}\" Name=\"Date\" DisplayName=\"Date\" Required=\"FALSE\" ReadOnly=\"TRUE\" Format=\"DateOnly\" />"
          ]
        },
        {
          "verb": "addContentType",
          "name": "Folder",
          "id": "0x0120"
        },
        {
          "verb": "addSPView",
          "name": "All Items",
          "viewFields": [
            "LinkTitle",
            "Description",
            "Category",
            "Duedate",
            "Important",
            "Status",
            "Date"
          ],
          "query": "",
          "rowLimit": 30,
          "isPaged": true,
          "formatterJSON": "",
          "replaceViewFields": true
        },
        {
          "verb": "addSPView",
          "name": "To Do",
          "viewFields": [
            "LinkTitle",
            "Description",
            "Category",
            "Duedate",
            "Important",
            "Status",
            "Date",
            "Created",
            "Author",
            "Modified",
            "Editor"
          ],
          "query": "<GroupBy Collapse=\"FALSE\" GroupLimit=\"30\"><FieldRef Name=\"Status\" /></GroupBy><OrderBy><FieldRef Name=\"Important\" Ascending=\"FALSE\" /><FieldRef Name=\"Duedate\" /></OrderBy>",
          "rowLimit": 30,
          "isPaged": true,
          "makeDefault": true,
          "formatterJSON": "{\"$schema\":\"https://developer.microsoft.com/json-schemas/sp/v2/row-formatting.schema.json\",\"hideSelection\":true,\"hideListHeader\":true,\"rowFormatter\":{\"elmType\":\"div\",\"style\":{\"padding\":\"5px\",\"min-width\":\"97%\",\"border-bottom\":\"1px solid #e5e5e5\"},\"attributes\":{\"class\":\"ms-bgColor-neutralLight--hover ms-fontColor-neutralSecondaryâ€“hover\"},\"children\":[{\"elmType\":\"div\",\"customRowAction\":{\"action\":\"setValue\",\"actionInput\":{\"Status\":\"=if([$Status], '0' , '1' )\"}},\"attributes\":{\"class\":\"ms-fontColor-themePrimary\",\"iconName\":\"=if([$Status], 'SkypeCircleCheck' , 'CircleRing')\"},\"style\":{\"font-size\":\"1.2rem\",\"cursor\":\"pointer\",\"padding-left\":\"10px\"}},{\"elmType\":\"div\",\"style\":{\"text-align\":\"left\",\"padding\":\"5px\",\"margin-left\":\"10px\",\"width\":\"100%\"},\"children\":[{\"elmType\":\"div\",\"style\":{\"font-weight\":\"400\",\"font-size\":\"14px\",\"text-decoration\":\"=if([$Status], 'line-through' , '')\"},\"txtContent\":\"[$Title]\"},{\"elmType\":\"span\",\"style\":{\"font-size\":\"10px\",\"margin-right\":\"5px\",\"color\":\"=if([$Status], '', if(toLocaleDateString([$Duedate])==toLocaleDateString(@now),'#465efc',if([$Duedate] < @now, '#db3a29' , '')))\",\"display\":\"=if([$Duedate],'','none')\"},\"attributes\":{\"iconName\":\"Event\"}},{\"elmType\":\"span\",\"style\":{\"font-weight\":\"=if([$Status], '200', if([$Duedate] < @now, '500' , '200'))\",\"font-size\":\"12px\",\"overflow\":\"hidden\",\"margin-top\":\"2px\",\"white-space\":\"nowrap\",\"color\":\"=if([$Status], '', if(toLocaleDateString([$Duedate])==toLocaleDateString(@now),'#465efc',if([$Duedate] < @now, '#db3a29' , '')))\",\"display\":\"=if([$Duedate],'','none')\"},\"txtContent\":{\"operator\":\"+\",\"operands\":[\"=if(toLocaleDateString([$Duedate])==toLocaleDateString(@now),'Today ',if([$Duedate] > @now, 'Due, ' , 'Overdue, '))\",\"=if(toLocaleDateString([$Duedate])!=toLocaleDateString(@now), [$Date], '')\"]}},{\"elmType\":\"span\",\"style\":{\"font-size\":\"8px\",\"margin\":\"0 10px\",\"font-weight\":\"200\",\"display\":\"=if([$Description]=='', 'none', if([$Duedate],'','none'))\"},\"attributes\":{\"iconName\":\"LocationDot\"}},{\"elmType\":\"span\",\"style\":{\"font-size\":\"10px\",\"display\":\"=if([$Description]=='', 'none', '')\"},\"attributes\":{\"iconName\":\"QuickNote\"}},{\"elmType\":\"span\",\"style\":{\"font-size\":\"8px\",\"margin\":\"0 10px\",\"font-weight\":\"200\",\"display\":\"=if([$Category]=='', 'none', '')\"},\"attributes\":{\"iconName\":\"LocationDot\"}},{\"elmType\":\"span\",\"style\":{\"font-size\":\"11px\",\"display\":\"=if([$Category]=='', 'none', '')\"},\"attributes\":{\"iconName\":\"Tag\"}},{\"elmType\":\"span\",\"style\":{\"font-size\":\"11px\",\"font-weight\":\"200\",\"margin-left\":\"5px\",\"display\":\"=if([$Category]=='', 'none', '')\"},\"txtContent\":\"[$Category]\"},{\"elmType\":\"span\",\"style\":{\"font-size\":\"8px\",\"margin\":\"0 10px\",\"font-weight\":\"200\",\"display\":\"=if([$Attachments] == '0', 'none', '')\"},\"attributes\":{\"iconName\":\"LocationDot\"}},{\"elmType\":\"span\",\"style\":{\"font-size\":\"11px\",\"display\":\"=if([$Attachments] == '0', 'none', '')\",\"cursor\":\"pointer\"},\"attributes\":{\"iconName\":\"Attach\"},\"customRowAction\":{\"action\":\"defaultClick\"}}]},{\"elmType\":\"span\",\"attributes\":{\"iconName\":\"=if([$_CommentCount], 'Comment', 'CommentAdd')\",\"class\":\"=if([$_CommentCount], 'ms-fontColor-themePrimary', '')\"},\"style\":{\"font-size\":\"14px\",\"padding-right\":\"15px\",\"cursor\":\"pointer\"},\"customRowAction\":{\"action\":\"defaultClick\"}},{\"elmType\":\"span\",\"attributes\":{\"iconName\":\"=if([$Important], 'FavoriteStarFill', 'FavoriteStar')\",\"class\":\"=if([$Important], 'ms-fontColor-themePrimary', '')\"},\"style\":{\"font-size\":\"16px\",\"padding-right\":\"10px\",\"cursor\":\"pointer\"},\"customRowAction\":{\"action\":\"setValue\",\"actionInput\":{\"Important\":\"=if([$Important], '0' , '1' )\"}}}],\"customCardProps\":{\"formatter\":{\"elmType\":\"div\",\"style\":{\"padding\":\"20px\"},\"children\":[{\"elmType\":\"div\",\"children\":[{\"elmType\":\"div\",\"style\":{\"width\":\"350px\",\"font-size\":\"14px\",\"font-weight\":\"700\",\"margin-bottom\":\"5px\"},\"txtContent\":\"[$Title]\",\"inlineEditField\":\"[$Title]\"},{\"elmType\":\"div\",\"style\":{\"width\":\"350px\",\"font-size\":\"14px\",\"font-weight\":\"400\",\"margin-bottom\":\"5px\",\"font-style\":\"=if([$Description]=='','Italic','')\"},\"txtContent\":\"=if([$Description]=='','Add note','[$Description]')\",\"inlineEditField\":\"[$Description]\"},{\"elmType\":\"div\",\"style\":{\"width\":\"350px\",\"font-size\":\"12px\",\"font-weight\":\"200\",\"margin-bottom\":\"5px\"},\"children\":[{\"elmType\":\"span\",\"style\":{\"font-size\":\"11px\"},\"attributes\":{\"iconName\":\"Event\"}},{\"elmType\":\"span\",\"style\":{\"font-size\":\"12px\",\"margin-left\":\"5px\",\"font-weight\":\"200\",\"font-style\":\"=if('=toLocaleDateString([$Duedate])'=='','Italic','')\"},\"txtContent\":\"=if('=toLocaleDateString([$Duedate])'=='','Add due date', '=toLocaleDateString([$Duedate])')\",\"inlineEditField\":\"[$Duedate]\"}]},{\"elmType\":\"div\",\"style\":{\"width\":\"350px\",\"font-size\":\"12px\",\"font-weight\":\"200\",\"margin-bottom\":\"10px\",\"padding-bottom\":\"10px\",\"border-bottom\":\"1px solid #e5e5e5\"},\"children\":[{\"elmType\":\"span\",\"style\":{\"font-size\":\"11px\"},\"attributes\":{\"iconName\":\"Tag\"}},{\"elmType\":\"span\",\"style\":{\"font-size\":\"12px\",\"margin-left\":\"5px\",\"font-weight\":\"200\",\"font-style\":\"=if([$Category]=='','Italic','')\"},\"txtContent\":\"=if([$Category]=='','Pick a category',[$Category])\",\"inlineEditField\":\"[$Category]\"}]},{\"elmType\":\"div\",\"children\":[{\"elmType\":\"div\",\"style\":{\"font-size\":\"12px\",\"font-weight\":\"200\"},\"txtContent\":{\"operator\":\"+\",\"operands\":[\"Created: \",\"=toLocaleString([$Created])\"]}},{\"elmType\":\"div\",\"style\":{\"margin-bottom\":\"5px\"},\"children\":[{\"elmType\":\"img\",\"style\":{\"width\":\"12px\",\"height\":\"12px\",\"border-radius\":\"50%\",\"margin-right\":\"5px\"},\"attributes\":{\"src\":\"=getUserImage([$Author.email], 'S')\",\"title\":\"[$Author.title]\"}},{\"elmType\":\"span\",\"txtContent\":\"[$Author.title]\",\"style\":{\"font-size\":\"12px\",\"font-weight\":\"200\"}}]},{\"elmType\":\"div\",\"style\":{\"font-size\":\"12px\",\"font-weight\":\"200\"},\"txtContent\":{\"operator\":\"+\",\"operands\":[\"Updated: \",\"=toLocaleString([$Modified])\"]}},{\"elmType\":\"div\",\"children\":[{\"elmType\":\"img\",\"style\":{\"width\":\"12px\",\"height\":\"12px\",\"border-radius\":\"50%\",\"margin-right\":\"5px\"},\"attributes\":{\"src\":\"=getUserImage([$Editor.email], 'S')\",\"title\":\"[$Editor.title]\"}},{\"elmType\":\"span\",\"txtContent\":\"[$Editor.title]\",\"style\":{\"font-size\":\"12px\",\"font-weight\":\"200\"}}]},{\"elmType\":\"span\",\"style\":{\"font-size\":\"14px\",\"cursor\":\"pointer\",\"position\":\"absolute\",\"bottom\":\"20px\",\"right\":\"20px\"},\"attributes\":{\"iconName\":\"Delete\"},\"customRowAction\":{\"action\":\"delete\"}}]}]}]},\"openOnEvent\":\"hover\",\"directionalHint\":\"bottomCenter\",\"isBeakVisible\":true,\"beakStyle\":{\"backgroundColor\":\"white\"}}},\"groupProps\":{\"headerFormatter\":{\"elmType\":\"div\",\"style\":{\"flex-direction\":\"row\"},\"children\":[{\"elmType\":\"div\",\"style\":{\"padding\":\"4px 8px 5px 8px\",\"border-radius\":\"6px\",\"font-weight\":\"500\",\"cursor\":\"pointer\"},\"attributes\":{\"class\":{\"operator\":\"+\",\"operands\":[\"ms-bgColor-themePrimary \",\"ms-fontColor-white\"]}},\"children\":[{\"elmType\":\"div\",\"style\":{\"display\":\"inline-flex\",\"padding-right\":\"9px\"},\"children\":[{\"elmType\":\"div\",\"style\":{\"padding-left\":\"5px\"},\"attributes\":{\"class\":\"ms-fontWeight-bold\"},\"txtContent\":\"=if(@group.fieldData.displayValue == 'Yes', 'Completed', 'To Do')\"},{\"elmType\":\"div\",\"style\":{\"padding-left\":\"5px\"},\"attributes\":{\"class\":\"ms-fontWeight-normal\"},\"txtContent\":{\"operator\":\"+\",\"operands\":[\" - \",\"=@group.count\",\"= if(@group.count!= 1,' items',' item')\"]}}]}]}]}}}",
          "replaceViewFields": true
        },
        {
          "verb": "setClientFormCustomFormatter",
          "clientFormCustomFormatter": {
            "headerJSONFormatter": {
              "elmType": "div",
              "style": {
                "border-bottom": "1px solid #c5c5c5",
                "margin-bottom": "16px"
              },
              "children": [
                {
                  "elmType": "div",
                  "style": {
                    "display": "flex",
                    "box-sizing": "border-box",
                    "align-items": "center"
                  },
                  "children": [
                    {
                      "elmType": "div",
                      "attributes": {
                        "iconName": "=if([$Duedate] > @now,'','Warning')"
                      },
                      "style": {
                        "flex": "none",
                        "padding": "0px",
                        "padding-left": "0px",
                        "margin-right": "5px",
                        "font-size": "30px",
                        "font-weight": "700",
                        "display": "=if([$Status], 'none', if(toLocaleDateString([$Duedate])=='', 'none', if([$Duedate] <= @now, 'block' , 'none')))",
                        "color": "=if([$Status], '#000', if(toLocaleDateString([$Duedate])=='', '#000', if([$Duedate] <= @now, '#db3a29' , '#000')))"
                      }
                    }
                  ]
                },
                {
                  "elmType": "div",
                  "style": {
                    "box-sizing": "border-box",
                    "width": "100%",
                    "text-align": "left",
                    "overflow": "hidden",
                    "margin-bottom": "10px",
                    "font-size": "24px",
                    "font-weight": "700",
                    "padding-top": "4px",
                    "color": "=if([$Status], '#000', if(toLocaleDateString([$Duedate])=='', '#000', if([$Duedate] <= @now, '#db3a29' , '#000')))"
                  },
                  "children": [
                    {
                      "elmType": "div",
                      "txtContent": "=if([$Title]=='','Add a task','[$Title]')"
                    }
                  ]
                }
              ]
            },
            "footerJSONFormatter": "",
            "bodyJSONFormatter": ""
          }
        }
      ]
    }
  ]
}